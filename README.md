# Автоматическая фильтрация изображений животных

Мы представляем решение для атоматической фильтрации изображений, полученных с фотоловушек, на пригодность для дальнейшего анализа научными работниками.
Наше решение представляет собой веб-сервис, на котором пользователь с удобством и меньшими, в сравнении с ручной обработкой, временными затратами может получить необходимую информацию об изображениях  с фотоловушек. Пользователь загружает изображения и в реальном времени может отслеживать процесс обработки. Во время обработки фотографии проходят через несколько моделей:
1. SWIN transformer для классификации изображений на пустое/не пустое
2. Yolov8 для выделения области, где находится животное и дальнейшего обрезания изображения по контуру Bounding Box;
3.1 SWIN transformer для классификации обрезанного изображения - либо изображение, пригодное для дальнейшего анализа, либо вспомогательное изображение;
3.2 Yolov8-seg для сегментации частей тела животного, с помощью чего можно понять, какие части тела находятся в кадре и с помощью скрипта выяснить, подходит ли изображение для дальнейшего анализа или же является вспомогательным;
4. RandomForest для подведения итогов обработки. Эта модель проводит анализ полученных ответов от предыдущих моделей и выносит финальный вердикт, за счет нескольких признаков. 
После обработки моделями изображения выводятся на веб-сервис, где пользователь может просмотреть и скачать фотографии, посмотреть и выгрузить отчет по изображениям. 

## Доступ

Для проверки развертывания или тестирования моделей вы можете скачать наши обученные веса по ссылке с яндекс диска https://disk.yandex.ru/d/sG6D3SuWDfEX9Q

## Обучение

- yolo_seg_train.ipynb - юпитер для обучения модели сегментации yolov8
- torch_classifier_train.ipynb - юпитер для обучения моделей классификации
- preprocessor.ipynb - юпитер для сборки параметров в датасет
- ml_train.ipynb - юпитер для обучения Random Forest
- submit_creation.ipynb - юпитер для создания сабмитов
- req_train.txt - зависимости для обучения моделей

Чтобы запустить обучение или тестирование, установите в свое виртуальное окружение зависимости, например ``` pip install -r req_train.txt```

## Развертывание
в api-modeling добавить веса
- Запустить:
- ``` docker-compose up -d --build  ```
- Используется для соединения обработки передовая текущие состояния
- Основной путь для установления socet:
> @app.websocket("/{item_id}/ws")

## Api-modeling 
Приложение для взаимодействия с моделями

## Django
Небольшое приложение с templates и статикой в роли фронтенда


